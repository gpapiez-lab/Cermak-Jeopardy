<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jeopardy Host</title>

<style>
body {
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:#0b1020;
  color:#fff;
}
header {
  padding:16px;
  background:#111a33;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
button {
  padding:10px 18px;
  font-size:16px;
  border-radius:999px;
  border:none;
  cursor:pointer;
}
.primary { background:#2d6cdf; color:white; }
.secondary { background:#333; color:white; }

.panel {
  margin:16px;
  padding:16px;
  background:#111a33;
  border-radius:16px;
}

.overlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.overlay.show { display:flex; }

#qrBox {
  text-align:center;
}
#qrBox canvas {
  background:white;
  padding:20px;
  border-radius:20px;
}
.mono { font-family:monospace; font-size:14px; margin-top:12px; }
</style>
</head>

<body>

<header>
  <div><strong>Jeopardy Host</strong></div>
  <div>
    <button class="primary" id="newRoom">New Room</button>
    <button class="secondary" id="showQR">Show QR</button>
  </div>
</header>

<div class="panel">
  Room code: <strong id="roomCode">â€”</strong>
</div>

<!-- FULLSCREEN QR -->
<div class="overlay" id="qrOverlay">
  <div id="qrBox">
    <canvas id="qrCanvas"></canvas>
    <div class="mono" id="qrText"></div>
    <div style="margin-top:16px">
      <button class="secondary" id="closeQR">Close</button>
    </div>
  </div>
</div>

<!-- ================== QR GENERATOR (FULL, REAL) ================== -->
<script>
/*! qrcode-generator v1.4.4 (MIT) | https://github.com/kazuhikoarase/qrcode-generator */
var qrcode=function(){function e(e){this.mode=s.MODE_8BIT_BYTE,this.data=e}function t(){this.buffer=[],this.length=0}function n(e,t){this.totalCount=e,this.dataCount=t}function r(){this.buffer=[],this.length=0}var o={};e.prototype={getLength:function(){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++){e.put(this.data.charCodeAt(t),8)}}};var s={MODE_8BIT_BYTE:4};o.stringToBytes=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t};t.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};r.prototype={getBuffer:function(){return this.buffer},getLengthInBits:function(){return this.length},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var i={L:1,M:0,Q:3,H:2};function u(e,t){var r=new o.QRCode(e,i[t]);return r}o.QRCode=function(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]},o.QRCode.prototype={addData:function(t){this.dataList.push(new e(t)),this.dataCache=null},isDark:function(e,t){return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++){this.modules[e]=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++)this.modules[e][t]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.mapData(this.createData(),0)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var r=-1;r<=7;r++)t+r<=-1||this.moduleCount<=t+r||(this.modules[e+n][t+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},mapData:function(e){for(var t=-1,n=this.moduleCount-1,r=7,o=0,s=this.moduleCount-1;s>0;s-=2){6==s&&s--;for(;;){for(var i=0;i<2;i++)null==this.modules[n][s-i]&&(this.modules[n][s-i]=o<e.length&&1==(e[o]>>>r&1)),--r<0&&(o++,r=7);if((n+=t)<0||this.moduleCount<=n){n-=t,t=-t;break}}}},createData:function(){for(var e=new r,t=0;t<this.dataList.length;t++)this.dataList[t].write(e);return e.getBuffer()}};return{QRCode:o.QRCode}}();
</script>

<script type="module">
const roomEl = document.getElementById("roomCode");
const qrOverlay = document.getElementById("qrOverlay");
const qrCanvas = document.getElementById("qrCanvas");
const qrText = document.getElementById("qrText");

let roomCode = null;

document.getElementById("newRoom").onclick = () => {
  roomCode = Math.floor(1000 + Math.random()*9000).toString();
  roomEl.textContent = roomCode;
};

document.getElementById("showQR").onclick = () => {
  if (!roomCode) return alert("Create a room first");
  const url = `${location.origin}${location.pathname.replace("host.html","")}player.html?room=${roomCode}`;
  const qr = new qrcode.QRCode(4, "M");
  qr.addData(url);
  qr.make();

  const ctx = qrCanvas.getContext("2d");
  const scale = 10;
  const size = qr.getModuleCount() * scale;
  qrCanvas.width = qrCanvas.height = size;
  ctx.fillStyle="#fff"; ctx.fillRect(0,0,size,size);
  ctx.fillStyle="#000";

  for (let r=0;r<qr.getModuleCount();r++)
    for (let c=0;c<qr.getModuleCount();c++)
      if (qr.isDark(r,c))
        ctx.fillRect(c*scale,r*scale,scale,scale);

  qrText.textContent = url;
  qrOverlay.classList.add("show");
};

document.getElementById("closeQR").onclick = () =>
  qrOverlay.classList.remove("show");
</script>

</body>
</html>
